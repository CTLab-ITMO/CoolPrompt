"""
Base Evaluation Class

Provides base class for evaluating NLP models
on different tasks with standardized metrics and output formatting.
"""

from abc import ABC
from typing import List

from metrics import BaseMetric


class BaseNLPEvaluator(ABC):
    def __init__(self, model, metric: BaseMetric):
        self.model = model
        self.metric = metric

    def evaluate(
        self,
        prompt: str,
        dataset: List[str],
        targets: List[str] | List[int],
    ) -> float:
        answers = [self.model.invoke(prompt + "\n" + sample) for sample in dataset]
        return self.metric.compute(answers, targets)
